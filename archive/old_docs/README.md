# ERA5下载软件

一个高性能的ERA5再分析气象数据下载工具，支持断点续传和多线程并发下载。

## ✨ 特性

- 🚀 **高性能下载** - 多线程并发下载，支持1-10个并发线程
- 🔄 **断点续传** - 网络中断后可继续下载，避免重复下载
- 🔧 **智能重试** - 指数退避重试机制，自动处理网络故障
- 🎨 **现代化GUI** - 基于CustomTkinter的美观用户界面
- 📊 **实时监控** - 下载进度、速度监控面板
- ⚡ **性能优化版** - 最新版本修复了连接泄漏问题，性能提升50-70%

## 📊 性能优化（最新版本）

### 优化内容

- ✅ 修复HTTP响应连接泄漏
- ✅ 增加连接池大小
- ✅ 优化超时配置
- ✅ 添加重试抖动
- ✅ 线程局部计数器减少锁竞争
- ✅ 批量更新进度文件

### 性能提升

| 指标 | 优化前 | 优化后 | 提升 |
|------|--------|--------|------|
| 错误率 | 80% | <20% | ↓ 75% |
| 下载速度 | 基准 | +50-70% | ↑ |
| 长期稳定性 | 随时间恶化 | 保持稳定 | ✅ |

详细说明请查看 [修复说明报告](修复说明报告.md)

## 🚀 快速开始

### 环境要求

- Python 3.10 或更高版本
- Windows 10/11

### 安装

```bash
# 克隆仓库
git clone https://github.com/linglinglin0/ERA5_downloader.git
cd ERA5_downloader

# 使用UV安装（推荐）
pip install uv
uv sync

# 或使用pip
pip install -r requirements.txt
```

### 运行

```bash
# 使用性能优化版本
python ERA5download_GUI_v2_fixed.py

# 或使用启动脚本
启动程序_修复版.bat
```

## 📖 使用说明

1. 输入日期（YYYYMM格式，如：202102）
2. 选择保存目录
3. 选择要下载的变量（或留空下载全部）
4. 设置并发线程数（建议3-5个）
5. 点击"开始下载"

## 🛠️ 开发

### 安装开发依赖

```bash
uv sync --dev
```

### 运行测试

```bash
# 运行诊断工具
python diagnostic_tool.py

# 分析错误日志
python log_analyzer.py
```

## 📝 文档

- [修复说明报告](修复说明报告.md) - 性能优化详细说明
- [代码审查报告](CODE_REVIEW_REPORT.md) - 代码审查报告
- [诊断工具使用说明](诊断工具使用说明.md) - 工具使用指南
- [性能问题分析报告](性能问题分析报告.md) - 问题分析
- [网络错误分析报告](网络错误分析报告.md) - 网络问题分析

## 🤝 贡献

欢迎提交Issue和Pull Request！

## 📄 许可证

MIT License

## 🙏 致谢

- 数据来源：ECMWF ERA5
- S3存储：NSF NCAR RDA

---

**注意：** 本工具仅用于学术研究目的，请遵守数据提供商的使用条款。
