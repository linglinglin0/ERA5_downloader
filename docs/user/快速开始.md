# 快速开始指南

欢迎使用 ERA5 数据下载工具！本指南将帮助你在 5 分钟内开始下载 ERA5 气象数据。

## 📋 前置要求

- **Python 版本**: 3.8 或更高
- **操作系统**: Windows / Linux / macOS
- **网络连接**: 需要能够访问 AWS S3 服务
- **磁盘空间**: 根据下载数据量准备足够空间（通常每月数据约 10-50 GB）

## 🚀 安装步骤

### 1. 安装 Python 依赖

打开终端或命令提示符，运行：

```bash
pip install -r requirements.txt
```

或者手动安装核心依赖：

```bash
pip install customtkinter boto3
```

### 2. 启动应用程序

```bash
python src/ERA5download_GUI.py
```

或者在 Windows 上直接双击运行：
- 创建快捷方式指向 `src\ERA5download_GUI.py`
- 使用 Python Launcher 打开

## 📖 基本使用流程

### 第一步：设置下载参数

1. **输入日期**
   - 在"年月"输入框中输入目标日期
   - 格式：`YYYYMM`（例如：`202510` 表示 2025 年 10 月）

2. **选择保存目录**
   - 点击"选择文件夹"按钮
   - 选择或创建一个用于存放数据的目录
   - 建议使用专门的文件夹，如 `D:\ERA5数据\`

3. **选择变量（可选）**
   - 勾选需要下载的变量
   - 不勾选任何变量时，默认下载全部变量
   - 常用变量：
     - `t`: 温度
     - `u`: U 方向风
     - `v`: V 方向风
     - `q`: 比湿

4. **设置线程数**
   - 拖动滑块设置并发下载线程数
   - 范围：1-10 个线程
   - 推荐值：5 个线程（稳定网络可使用 8-10 个）

### 第二步：开始下载

1. 点击"开始下载"按钮
2. 程序会自动：
   - 扫描 S3 存储桶中的文件
   - 检查本地已完成的文件
   - 开始下载剩余文件

### 第三步：监控进度

观察监控面板：
- **进度区域**：显示每线程的实时进度（百分比）
- **日志区域**：显示下载速度、剩余文件数等信息
- **已完成/总数**：实时更新下载进度

### 第四步：完成或暂停

- **正常完成**：所有文件下载完毕后会显示提示
- **手动暂停**：点击"停止并关闭"会保留临时文件供续传
- **程序关闭**：下次打开会自动恢复配置

## ✨ v2.1 新特性

### 断点续传

不用担心网络中断！程序会自动：

- **网络错误自动重试**：失败后自动重试 3 次
- **保留下载进度**：临时文件（`.tmp`）会被保留
- **智能续传**：重新启动时自动从断点继续

示例：
```
文件1.nc: 100 MB | 进度: 75% | 断点续传 75.5MB
```

### 配置自动记忆

程序会自动保存你的设置：

- ✅ 日期
- ✅ 保存目录路径
- ✅ 并发线程数
- ✅ 勾选的变量列表

下次打开时无需重新设置！

## 🎯 使用示例

### 示例 1：下载单月数据

**目标**：下载 2025 年 1 月的温度和风速数据

**步骤**：
1. 日期输入：`202501`
2. 选择目录：`D:\ERA5数据\2025年1月\`
3. 勾选变量：`t`（温度）、`u`（U 风）、`v`（V 风）
4. 线程数：5
5. 点击"开始下载"

**预计时间**：约 30 分钟（取决于网速）

### 示例 2：批量下载多月数据

**目标**：下载 2024 年 10-12 月的全部数据

**步骤**：
1. 第一次运行：
   - 日期：`202410`
   - 目录：`D:\ERA5数据\2024年第4季度\`
   - 不勾选任何变量（下载全部）
   - 线程数：8
2. 第二次运行：
   - 日期：`202411`
   - 其他设置保持不变
3. 第三次运行：
   - 日期：`202412`
   - 其他设置保持不变

### 示例 3：断点续传场景

**场景**：下载到一半时网络中断

**处理方法**：
1. 重新启动程序
2. 保持相同的日期和目录设置
3. 点击"开始下载"
4. 程序会自动：
   - 跳过已完成的文件
   - 继续下载未完成的文件
   - 从临时文件的断点位置恢复

## ⚠️ 常见问题

### Q1: 下载速度很慢？

**解决方法**：
- 增加线程数到 8-10
- 检查网络带宽
- 避开网络高峰时段

### Q2: 提示"网络错误"？

**处理方法**：
- 程序会自动重试 3 次
- 检查网络连接
- 如果持续失败，尝试减少线程数

### Q3: 磁盘空间不足？

**预防措施**：
- 每月数据约 10-50 GB
- 分批下载不同月份
- 定期清理不需要的数据

### Q4: 如何知道下载完成了？

**确认方法**：
- 进度区域显示"完成"
- 日志区域显示"所有文件已下载完成"
- 目标文件夹中有 `.nc` 文件（无 `.tmp` 后缀）

## 📊 变量速查表

| 类别 | 变量代码 | 描述 | 单位 |
|------|---------|------|------|
| 温度 | `t` | 空气温度 | K |
| 风 | `u`, `v` | U/V 风分量 | m/s |
| 湿度 | `q` | 比湿 | kg/kg |
| 湿度 | `r` | 相对湿度 | % |
| 云 | `cc` | 云量 | 0-1 |
| 垂直运动 | `w` | 垂直速度 | Pa/s |
| 位势 | `z` | 位势高度 | m²/s² |

## 🔄 下一步

- 阅读详细功能：[新功能使用说明](新功能使用说明.md)
- 了解断点续传：[断点续传使用指南](断点续传使用指南.md)
- 查看开发文档：[开发文档索引](../dev/)

## 💡 小贴士

1. **首次使用**：建议先下载一个月的少量变量测试
2. **稳定下载**：使用有线网络比 WiFi 更稳定
3. **节省空间**：下载完成后可以删除临时 `.tmp` 文件
4. **批量下载**：编写脚本可以自动化多个月份下载

---

**需要帮助？** 查看完整文档：[返回主文档](../README.md)
