@echo off
chcp 65001 >nul
echo ================================================================================
echo                    ERA5下载器 + 性能监控器
echo ================================================================================
echo.
echo 此脚本将同时启动：
echo 1. ERA5下载器（修复版）
echo 2. 性能监控器
echo.
echo 请确保：
echo - 已选择正确的下载日期
echo - 已配置下载目录
echo - 已勾选需要下载的变量
echo.
echo 按任意键开始...
pause >nul

REM 获取脚本所在目录
cd /d "%~dp0"

echo.
echo ================================================================================
echo [1/2] 启动ERA5下载器（修复版）...
echo ================================================================================
echo.

start "ERA5下载器" uv run ERA5download_GUI_v2_fixed.py

echo [信息] 下载器已启动，窗口标题：ERA5下载器
echo.
echo 等待30秒，让下载器初始化...
timeout /t 30 /nobreak >nul

echo.
echo ================================================================================
echo [2/2] 启动性能监控器...
echo ================================================================================
echo.

echo [提示] 请在监控器中选择下载目录（与下载器中的日期目录对应）
echo.
echo 例如：如果下载日期是202510，下载目录是 D:\ERA5数据
echo       则在监控器中选择：D:\ERA5数据\202510
echo.
echo 按任意键继续启动监控器...
pause >nul

start "ERA5性能监控器" uv run era5_performance_monitor.py

echo.
echo ================================================================================
echo                          启动完成！
echo ================================================================================
echo.
echo 当前运行的窗口：
echo 1. ERA5下载器 - 设置并开始下载
echo 2. ERA5性能监控器 - 选择目录后开始监控
echo.
echo 提示：
echo - 下载器中设置好参数后，点击"开始下载"
echo - 监控器中选择对应的日期目录，点击"开始监控"
echo - 两个程序独立运行，互不影响
echo.
echo 停止下载时：
echo - 先在下载器中点击"停止并关闭"
echo - 监控器会自动检测并停止
echo.

REM 询问是否立即打开监控器目录选择
set /p auto="是否自动打开监控器的目录选择提示？ (Y/N): "
if /i "%auto%"=="Y" (
    echo.
    echo [提示] 请切换到"ERA5性能监控器"窗口进行操作
)

echo.
echo 按任意键退出此启动脚本...
pause >nul
