@echo off
chcp 65001 >nul
echo ================================================================================
echo                    ERA5下载软件 - 性能优化版
echo ================================================================================
echo.
echo 修复内容:
echo   [1] 修复连接泄漏（添加response.close()）
echo   [2] 增加连接池大小（workers*4）
echo   [3] 增加超时时间（60秒）
echo   [4] 添加重试抖动（±20%）
echo   [5] 优化锁竞争（线程局部计数）
echo   [6] 批量更新进度（减少I/O）
echo.
echo 预期效果: 性能提升50-70%%，错误率降低70-80%%
echo.
echo ================================================================================
echo.
echo 正在启动...
echo.

cd /d "%~dp0"
C:\Users\Administrator\.local\bin\uv.exe run python ERA5download_GUI_v2_fixed.py

if errorlevel 1 (
    echo.
    echo ================================================================================
    echo 程序异常退出，错误代码: %errorlevel%
    echo ================================================================================
    echo.
)

pause
